$.extend({init:function(){_this=this,_this.exchangeApi=$.requestUrlPrefix+"/exchange/getExchangeListByType",_this.transApi=$.requestUrlPrefix+"/pay/transfer",_this.recordApi=$.requestUrlPrefix+"/pay/getTransferRecord",_this.goExchangeApi=$.requestUrlPrefix+"/pay/exchange",_this.href=window.location.href,_this.trueNum=1,_this.params={},_this.exchangeId,-1!=_this.href.indexOf("exchange")?_this.trueNum=1:-1!=_this.href.indexOf("wx_pub")&&(_this.trueNum=2),_this.params={openId:$.getCookie("openId"),type:_this.trueNum},$.postDate(_this.exchangeApi,_this.params,function(e){"200"==e.code?1==_this.trueNum?$.exchangeFn(e):2==_this.trueNum&&$.withdrawalsFn(e):"400_5"==e.code&&(window.location.href="login.jsp")}),$(".exchange_list").delegate("ul li","click",function(){$(".exchange_list ul li").removeClass("on"),$(this).addClass("on"),_this.exchangeId=$(this).attr("data-id"),_this.exchangeBi=$(this).find("span.gold_dou").text()}),$(".exchange_list_wiht").delegate("ul li","click",function(){$(".exchange_list_wiht ul li").removeClass("on"),$(this).addClass("on"),_this.exchangeId=$(this).attr("data-id"),_this.exchangeGoldBi=$(this).find("span.gold_dou").text(),_this.exchangeGold=$(this).find("span.gold_bi").text(),console.log(_this.exchangeGoldBi)}),$(".duihuan").click(function(){return void 0==_this.exchangeId||""==_this.exchangeId?void $.tempTip("请选择兑换的金币数"):void(parseInt(_this.exchangeBi)>parseInt($(".bean_num").html())?$.tempTip("您的金豆数量不足！"):$.postDate(_this.goExchangeApi,"exchangeId="+_this.exchangeId,function(e){"200"==e.code?($(".buy-ok").show(),$(".skyBox").show(),$(".gold-num").html($(".on .gold_bi").html()),$(".bean_num").html(e.result.point)):"400_5"==e.code&&(window.location.href="login.jsp")}))}),$(".tixian").click(function(){if(void 0==_this.exchangeId||""==_this.exchangeId)$.tempTip("请选择提现金额");else{if(parseInt(_this.exchangeGoldBi)>parseInt($(".bean_num").html()))return void $.tempTip("您的金豆数量不足！");$.postDate(_this.transApi,"transferId="+_this.exchangeId,function(e){"200"==e.code?($(".buy-ok").show(),$(".skyBox").show(),$(".gold-num").html($(".on .gold_bi").html()),$(".bean_num").html(e.result.point)):"400_5"==e.code?window.location.href="login":$.tempTip(e.message)})}}),$(".close-btn").click(function(){$(".buy-ok,.skyBox").hide()})},recordFn:function(e){$.postDate(_this.recordApi,e,function(e){"200"==e.code?1==_this.trueNum?$.recordList1(e):2==_this.trueNum&&$.recordList2(e):"400_5"==e.code&&(window.location.href="login.jsp")})},recordList1:function(e){$(".record_exchange .dou_num").html(e.result.pointCount),""==e.result.list?$(".record_exchange_list").html("<h2>暂无兑换记录</h2>"):($(".record_exchange_list ul").empty(),$.each(e.result.list,function(e,t){var i='<li><span class="gold_bi"><em class="gold_bi_icon"></em>'+t.diamond+"<em>"+t.exchangePoint+'金豆</em> </span><span class="gold_dou">'+t.date+"</span></li>";$(".record_exchange_list ul").append(i)}))},recordList2:function(e){$(".money_num").html(e.result.price/100),$(".record_list_wiht .dou_num").html(e.result.pointCount+"金豆"),""==e.result.list?$(".record_wiht_list").html("<h2>暂无提现记录</h2>"):($(".record_wiht_list ul").empty(),$.each(e.result.list,function(e,t){var i='<li><span class="gold_bi">￥'+t.amount/100+"<em>"+t.exchangePoint+'金豆</em> </span><span class="gold_dou">'+t.date+"</span></li>";$(".record_wiht_list ul").append(i)}))},withdrawalsFn:function(e){$.each(e.result,function(e,t){var i='<li data-id="'+t.id+'"><span class="gold_bi">￥ '+t.price+'</span><span class="gold_dou">'+t.pointCount+'<em class="gold_dou_icon"></em></span></li>';$(".exchange_list_wiht ul").append(i)}),$(".bean_num").html(e.extraData)},exchangeFn:function(e){$.each(e.result,function(e,t){var i='<li data-id="'+t.id+'"><span class="gold_bi"><em class="gold_bi_icon"></em>'+t.diamondCount+'</span><span class="gold_dou">'+t.pointCount+' <em class="gold_dou_icon"></em></span></li>';$(".exchange_list ul").append(i)}),$(".bean_num").html(e.extraData)}}),$.init();