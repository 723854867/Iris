define(["../libs/jquery-2.1.4","../common/info","../common/share","../common/browse","../service/service"],function(i,t,n,e,o){var s=t.getPicPerfix(),a=t.getRequestPrefix(),c=$("#liveActivityId").val(),r={init:function(){var i=$(".latest"),n=$(".rank"),e=$(".rankContent"),o=$(".latestContent");r.renderFun(),r.swiperFn(i,n,e,o),r.hotList(e),r.newList(o),r.jump(),$(window).scroll(function(){$(window).scrollTop()>=$(".head").height()+$(".main").height()+8?$(".checkNav").css({position:"fixed",top:"0","z-index":"99"}):$(".checkNav").css({position:"inherit",top:"0","z-index":"99"}),t.lazyPicLoad($(".hotPic"))}),$(".canyu a").on("click",function(){window.location.href="http://wopaitv.com"})},renderFun:function(){o.findLiveActivityById(c).done(function(i){var t=i.result;$("title").html(t.title);var n='<img class="activityCover" src="'+s+t.cover+'" /><h2 class="activityTitle">'+t.title+'</h2><div class="activeMsg"><span class="activeMsgCon">'+t.description+'</span><i class="active-desc-arrow"></i></div>';$(".main").append(n),$(".active-desc-arrow").click(function(){$(".activeMsgCon").toggleClass("drop-desc"),$(this).toggleClass("arrrow-up")}),$("#shareImg").attr("content",s+t.cover),$("#shareDescription").attr("content",t.description)})},goPage:function(i,n){var e="",o={};"userId"==i&&(e=a+"/user/userDetail?userId="+n,o={uid:uid}),t.postform(e,o)},noticeTime:function(i){function t(i,t){for(var n=""+i,e=n.length,o="",s=t;s-- >e;)o+="0";return o+n}var n=i.attr("data-time"),e=(new Date,new Date(parseInt(n)));i.text("直播时间："+e.getFullYear()+"-"+t(e.getMonth()+1,2)+"-"+t(e.getDate(),2)+" "+t(e.getHours(),2)+":"+t(e.getMinutes(),2))},createTime:function(i){function t(i,t){for(var n=""+i,e=n.length,o="",s=t;s-- >e;)o+="0";return o+n}var n=i.attr("data-time"),e=(new Date,new Date(parseInt(n)));i.text(t(e.getMonth()+1,2)+"."+t(e.getDate(),2)+" "+t(e.getHours(),2)+":"+t(e.getMinutes(),2))},makeLiveList:function(i,n){var e=i.liveList;if($.each(e,function(i,t){var e;e=t.title?t.title:t.anchorName;var o='<li><a href="javascript:void(0)"><img data-userPic="'+t.roomPic+'" data-roomId="'+t.id+'"src="" class="hotPic"><img class="Icon" src="'+a+'/img/icons-2x/live_icon.png"></a></li>';n.append(o)}),e.length<24){var o=i.backList;$.each(o,function(i,t){var e='<li><a href="javascript:void(0)"><img data-userPic="'+t.videoPic+'" data-roomId="'+t.liveNoticeId+'"src="" class="hotPic"><img class="Icon" src="'+a+'/img/icons-2x/review_icon.png"></a></li>';n.append(e)})}if(""==e&&""==o){var c='<img class="null" style="width:80%;display:block;margin:0 auto;" src="'+a+'/img/icons-2x/null.jpg" />';n.append(c),$(".checkContent .navContent .latestContent ul").css("position","inherit"),$(".checkContent .navContent .latestContent ul li").css("margin-left","0")}$(".latestContent ul li").css("height",$(window).width()/3),$(".latestContent ul li").css("width",$(window).width()/3),$(".latestContent ul").css("width",$(window).width()+6),t.personalPortrait(s,$(".hotPic")),t.personalPortrait(s,$(".hotUesrPic")),$(".latestContent ul li a").on("click",function(){window.location.href=a+"/live/shareLive?roomId="+$(this).find("img").attr("data-roomId")})},swiperFn:function(i,t,n,e){i.on("click",function(){$(this).addClass("on").removeClass("off"),t.removeClass("on").addClass("off"),e.show(),n.hide()}),t.on("click",function(){$(this).addClass("on").removeClass("off"),i.removeClass("on").addClass("off"),n.show(),e.hide()})},hotList:function(i){var t=$("#liveActivityId").val(),n=1,e=10;o.getRank(t,n,e).done(function(t){var n=t.result.rank,e=0;if(""==n){var o='<img class="null" style="width:80%;display:block;margin:0 auto;" src="'+a+'/img/icons-2x/null.jpg" />';i.find("ul").append(o),$(".checkContent .navContent .rankContent ul li").css({padding:"0","text-indent":"0",border:"none","margin-top":"2px"})}$.each(n,function(t,n){if(e++,e>3&&10>e)var o="<li><strong>0"+e+'</strong><img class="userPortrait" src="'+s+n.userInfo.pic+'"><span class="nickname">'+n.userInfo.name+'</span><span class="giftNum"><em></em><a>'+n.giftNumber+"</a></span></li>";else if(3>=e)var o='<li><img class="img'+e+' imgRank" src="'+a+"/img/icons-2x/ico"+e+'.png"><img class="userPortrait" src="'+s+n.userInfo.pic+'"><span class="nickname">'+n.userInfo.name+'</span><span class="giftNum"><em></em><a>'+n.giftNumber+"</a></span></li>";else var o="<li><strong>"+e+'</strong><img class="userPortrait" src="'+s+n.userInfo.pic+'"><span class="nickname">'+n.userInfo.name+'</span><span class="giftNum"><em></em><a>'+n.giftNumber+"</a></span></li>";i.find("ul").append(o)})})},newList:function(i){var t=1,n=24,e=1,s=$("#liveActivityId").val(),a=$(".latestContent ul");o.getLiveAndRecordList(t,n,e,s).done(function(i){r.makeLiveList(i.result,a)})},jump:function(i){$("body").on("touchstart",".down-Btn a,.downloadBtn,.openwopai,.bottomBanner a",function(i){i.preventDefault(),e.versions.ios&&(e.versions.isWeiBo?$(".skyBox").show():e.versions.isWx?window.location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.busap.myvideo&g_f=991653":window.location.href="https://itunes.apple.com/us/app/wo-pai-wo-jiu-shi-zhu-jiao/id934254637?ls=1&mt=8"),e.versions.android&&(e.versions.isWeiBo?$(".skyBox-anz").show():e.versions.isWx?window.location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.busap.myvideo&g_f=991653":window.location.href=t.appDownUrl),e.versions.isWx&&(window.location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.busap.myvideo&g_f=991653")}),$(".skyBox,.skyBox-anz").click(function(){$(this).hide()})}};r.init()});