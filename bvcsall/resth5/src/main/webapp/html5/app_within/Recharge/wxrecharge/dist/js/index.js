$.extend({init:function(){_this=this,_this.httpUrl="http://cdn.wopaitv.com/restwww/download/",_this.server="/restwww",_this.idverification=_this.server+"/pay/getUserInfo",_this.idpay=_this.server+"/pay/create",_this.getDiamondList=_this.server+"/live/getDiamondList",_this.ip=returnCitySN.cip,_this.id=0,_this.picSouce=$("#picSouceUrl").val();var t={userId:0,produceId:0,channel:"wx_pub",client_ip:_this.ip,openId:""},i=$("#openid").val();""!=i?t.openId=i:window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?scope=snsapi_base&response_type=code&redirect_uri=http%3A%2F%2Fapi.wopaitv.com%2Frestwww%2Fpay%2FwechatCallback&state=STATE&appid=wx8a908b16f1e26ade&connect_redirect=1#wechat_redirect",$.getCookie("userId")?(_this.id=$.getCookie("userId"),$(".id-txt").val(_this.id),$.postDate(_this.idverification,"userId="+_this.id,function(t){200==t.code?($(".user-name,.user-name2").html(t.result.name),$(".user-pho").attr("src",_this.httpUrl+t.result.pic),$(".one").hide(),$(".two").show(),$.setCookie("userId",_this.id)):$.tempTip(t.message)})):($(".one").show(),$(".two").hide()),$.postDate(_this.getDiamondList,"isApple=0",function(t){200==t.code?$.each(t.result,function(t,i){var e;e="0"==i.isGive?$("<li data-id='"+i.id+"'><img src='"+_this.picSouce+"/dist/img/gold.png' class='gold-icon'/><span class='list-left'>"+i.name+"</span><span class='list-right'>￥"+i.price+"</span></li>"):$("<li data-id='"+i.id+"'><img src='"+_this.picSouce+"/dist/img/gold.png' class='gold-icon'/><span class='list-left'>"+i.name+"</span><span class='list-middle'>赠送"+i.giveCount+"金币</span><span class='list-right'>￥"+i.price+"</span></li>"),$(".list-gold ul").append(e)}):$.tempTip(t.message)}),$(".get-tips").click(function(){$(".big-warp").show()}),$(".iKnow-btn").click(function(t){$(".big-warp").hide(),t.preventDefault(),$(document.body).animate({scrollTop:0})}),$(".right-btn").click(function(){var t=$(".id-txt");return _this.id=t.val(),isNaN(_this.id)?void $.tempTip("ID号必须为数字"):void(_this.id||""!=_this.id?$.postDate(_this.idverification,"userId="+_this.id,function(t){200==t.code?($(".user-name,.user-name2").html(t.result.name),$(".user-pho").attr("src",_this.httpUrl+t.result.pic),$(".one").hide(),$(".two").show(),$.setCookie("userId",_this.id)):$.tempTip(t.message)}):$.tempTip("账号不能为空！"))}),$(".switch-user").click(function(){$.getCookie("userId")?$(".id-txt").val(_this.id):$(".id-txt").val(""),$(".one").show(),$(".two").hide()}),$("body").delegate(".list-gold ul li","touchstart",function(){$(".list-gold ul li").removeClass("active"),$(this).addClass("active"),t.produceId=parseInt($(this).attr("data-id"))}),$(".buy-btn").click(function(){return t.userId=parseInt(_this.id),0==t.produceId?void $.tempTip("请选择购买的金币数"):($(".gold-num").html($(".active").find(".list-left").html()),void $.postDate(_this.idpay,"paramJson="+JSON.stringify(t),function(t){200==t.code?pingpp.createPayment(t.result,function(t,i){"success"==t?($.tempTip("支付成功"),$(".buy-ok,.skyBox").show()):"fail"==t?$.tempTip("支付失败"):"cancel"==t&&$.tempTip("取消支付")}):$.tempTip(t.message)}))}),$(".close-btn").click(function(){$(".buy-ok,.skyBox").hide()})},postDate:function(t,i,e){$.ajax({type:"post",url:t,data:i,success:e,beforeSend:function(t){$(".load-box").show(),t.setRequestHeader("access_token",$.access_token),t.setRequestHeader("uid",$.uid)},dataType:"json",complete:function(){$(".load-box").hide()}})},tempTip:function(t,i){var e=$('<div class="tipsWarp">'+t+"</div>");$("body").append(e),setTimeout(function(){e.remove()},2e3),i&&i()},setCookie:function(t,i,e){var s=new Date;s.setTime(s.getTime()+24*e*60*60*1e3);var o="expires="+s.toUTCString();document.cookie=t+"="+i+"; "+o+";path=/"},getCookie:function(t){for(var i=t+"=",e=document.cookie.split(";"),s=0;s<e.length;s++){for(var o=e[s];" "==o.charAt(0);)o=o.substring(1);if(-1!=o.indexOf(i))return o.substring(i.length,o.length)}return""},clearCookie:function(t){document.cookie=t+"=;expires=0;;path=/"}}),$.init();